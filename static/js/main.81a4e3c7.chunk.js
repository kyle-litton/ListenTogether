(this["webpackJsonplisten-together"]=this["webpackJsonplisten-together"]||[]).push([[0],{18:function(e,t,a){e.exports=a.p+"static/media/topLeft.7b0b5f12.png"},19:function(e,t,a){e.exports=a.p+"static/media/topRight.81a215e0.png"},23:function(e,t,a){e.exports=a.p+"static/media/logo.f4b3fff4.png"},37:function(e,t,a){e.exports=a.p+"static/media/devices.a3bb48b9.png"},39:function(e,t,a){e.exports=a(90)},48:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},89:function(e,t,a){},90:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(20),s=a.n(o),i=a(10),c=a(5),l=a(36),u=a(4),p=Object(c.c)({userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TOKEN":return Object(u.a)(Object(u.a)({},e),{},{token:t.payload});case"SET_USERNAME":return Object(u.a)(Object(u.a)({},e),{},{username:t.payload});case"SET_GROUP":return Object(u.a)(Object(u.a)({},e),{},{group:t.payload});case"SET_ISOWNER":return Object(u.a)(Object(u.a)({},e),{},{isOwner:t.payload});case"SET_OWNERTOKEN":return Object(u.a)(Object(u.a)({},e),{},{ownerToken:t.payload});default:return e}},uiReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoaded:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOADED":return Object(u.a)(Object(u.a)({},e),{},{isLoaded:t.payload});default:return e}}});a(48);var m=a(38),h=a(2),d=a(13),g=a(14),f=a(16),y=a(15),E="56666d131c0b4eec8da574b72b0827c1",b="https://accounts.spotify.com/authorize",v="https://kyle-litton.github.io/ListenTogether",N=["streaming","user-read-email","user-read-private","user-library-read","user-library-modify","user-read-playback-state","user-modify-playback-state","app-remote-control","user-modify-playback-state","user-read-currently-playing","user-read-playback-state"],k=function(e){return function(t){t({type:"ADD_TOKEN",payload:e})}},O=function(e){return function(t){t({type:"SET_USERNAME",payload:e})}},w=function(e){return function(t){t({type:"SET_GROUP",payload:e})}},G=function(e){return function(t){t({type:"SET_ISOWNER",payload:e})}},S=function(e){return function(t){t({type:"SET_OWNERTOKEN",payload:e})}},T=(a(49),a(23)),j=a.n(T),L=a(11),R=a.n(L),C=function(e){Object(f.a)(a,e);var t=Object(y.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"componentDidMount",value:function(){for(var e,t={},a=/([^&;=]+)=?([^&;]*)/g,r=window.location.hash.substring(1);e=a.exec(r);)t[e[1]]=decodeURIComponent(e[2]);t.access_token&&this.props.addToken(t.access_token)}},{key:"getUsername",value:function(){var e=this;R.a.ajax({url:"https://api.spotify.com/v1/me/",type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e.props.token)},success:function(t){e.props.setUsername(t.display_name)}})}},{key:"createGroup",value:function(){this.props.setIsOwner(!0),this.props.history.push("/start")}},{key:"joinGroup",value:function(){this.props.setIsOwner(!1),this.props.history.push("/start")}},{key:"render",value:function(){return n.a.createElement("div",{className:"Home"},n.a.createElement("header",{className:"Home-header"},n.a.createElement("img",{src:j.a,className:"Home-logo",alt:"logo"}),!this.props.token&&n.a.createElement("a",{className:"Home-btn",href:"".concat(b,"?client_id=").concat(E,"&redirect_uri=").concat(v,"&scope=").concat(N.join("%20"),"&response_type=token&show_dialog=true")},"Login to Spotify"),this.props.token&&n.a.createElement("div",{className:"Home-btnDiv"},this.getUsername(),n.a.createElement("p",{className:"Home-text"},"Create a new group that friends can join."),n.a.createElement("button",{className:"Home-createBtn",onClick:this.createGroup.bind(this)},"Create a Group"),n.a.createElement("p",{className:"Home-text"},"Join a group that already exists."),n.a.createElement("button",{className:"Home-joinBtn",onClick:this.joinGroup.bind(this)},"Join a Group")),n.a.createElement("p",{className:"Home-p"},"Created By Kyle Litton. ",n.a.createElement("a",{className:"Home-credit",href:"https://github.com/kyle-litton/ListenTogether"},"View Source"))))}}]),a}(r.Component),I=Object(i.b)((function(e){return{token:e.userReducer.token,username:e.userReducer.username}}),(function(e){return Object(c.b)({addToken:k,setUsername:O,setIsOwner:G},e)}))(C),D=(a(50),a(17)),_=(a(31),function(e){Object(f.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(d.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={data:[],intervalIsSet:!1},e.getDataFromDb=function(){fetch("https://listen-together-api.herokuapp.com/Groups/getData").then((function(e){return e.json()})).then((function(t){return e.setState({data:t})}))},e.handleGroup=function(){e.state.data.map((function(e){return e.groupName})).includes(e.props.group)?e.props.isOwner?Object(D.confirmAlert)({title:"Group Already Exists",message:"Enter a name that is not already taken.",buttons:[{label:"OK"}]}):(e.props.setOwnerToken(e.state.data.find((function(t){return t.groupName===e.props.group})).ownerToken),e.props.history.push("/group")):e.props.isOwner?R.a.ajax({url:"https://listen-together-api.herokuapp.com/Groups/putData",type:"POST",data:JSON.stringify({groupName:e.props.group,ownerName:e.props.username,ownerToken:e.props.token}),contentType:"application/json; charset=UTF-8",success:function(){e.props.setOwnerToken(e.props.token),e.props.history.push("/group")},error:function(){Object(D.confirmAlert)({title:"Error Creating Group ".concat(e.props.group),message:"Try Again",buttons:[{label:"OK"}]})}}):Object(D.confirmAlert)({title:"Group Does Not Exist",message:"Make sure you spelled the name of the group correctly.",buttons:[{label:"OK"}]})},e.handleInput=function(t){e.props.setGroup(t.target.value)},e}return Object(g.a)(a,[{key:"componentDidMount",value:function(){if(this.getDataFromDb(),!this.state.intervalIsSet){var e=setInterval(this.getDataFromDb,1e3);this.setState({intervalIsSet:e})}}},{key:"componentWillUnmount",value:function(){this.state.intervalIsSet&&(clearInterval(this.state.intervalIsSet),this.setState({intervalIsSet:null}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"Create"},n.a.createElement("header",{className:"Create-header"},n.a.createElement("img",{src:j.a,className:"Create-logo",alt:"logo"}),n.a.createElement("p",{className:"Create-p"},this.props.isOwner?"Create Group Name":"Enter Group Name"),n.a.createElement("form",{className:"Create-form"},n.a.createElement("input",{className:"input",type:"text",placeholder:"Enter Name Here",onChange:this.handleInput})),n.a.createElement("br",null),n.a.createElement("button",{className:"Create-startBtn",onClick:this.handleGroup.bind(this)},this.props.isOwner?"Start Group":"Join Group"),n.a.createElement("p",{className:"Home-p"},"Created By Kyle Litton. ",n.a.createElement("a",{className:"Home-credit",href:"https://github.com/kyle-litton/ListenTogether"},"View Source"))))}}]),a}(r.Component)),H=Object(i.b)((function(e){return{group:e.userReducer.group,token:e.userReducer.token,username:e.userReducer.username,isOwner:e.userReducer.isOwner,ownerToken:e.userReducer.ownerToken}}),(function(e){return Object(c.b)({setGroup:w,setOwnerToken:S},e)}))(_),U=function(e){return function(t){t({type:"SET_LOADED",payload:e})}},A=(a(51),a(18)),x=a.n(A),P=a(19),B=a.n(P),K=(a(52),a(37)),W=a.n(K),F=function(e){var t={backgroundImage:"url(".concat(e.item.album.images[0].url,")")};return""!==e.uri?n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"main-wrapper"},n.a.createElement("div",{className:"now-playing__img"},n.a.createElement("img",{src:e.item.album.images[0].url,alt:""})),n.a.createElement("div",{className:"background",style:t})," ")):n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"main-wrapper"},n.a.createElement("p",{className:"instructions"},"Press    ",n.a.createElement("img",{src:W.a,className:"device",alt:"device"}),'  , Then select "Listen Together" to play music.'),n.a.createElement("div",{className:"background",style:t})," "))},J=a(26),M=a.n(J),z=function(e){Object(f.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(d.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={data:[],intervalIsSet:!1,ownerToken:"",item:{album:{images:[{url:""}]},name:"",artists:[{name:""}],duration_ms:0},userUri:[],ownerPlaying:[],uri:"",sync:!1,position:0},e.getDataFromDb=function(){fetch("https://listen-together-api.herokuapp.com/Groups/getData").then((function(e){return e.json()})).then((function(t){return e.setState({data:t})}))},e}return Object(g.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(this.getDataFromDb(),!this.state.intervalIsSet){var t=setInterval(this.getDataFromDb,1e3);this.setState({intervalIsSet:t})}if(this.state.data.length>0){var a=this.state.data.find((function(t){return t.group===e.props.group}));this.setState({ownerToken:a.ownerToken}),this.getCurrentlyPlaying(this.state.ownerToken)}window.onbeforeunload=function(){return this.onUnload(),""}.bind(this),this.props.hasLoaded(!0)}},{key:"componentWillUnmount",value:function(){this.state.intervalIsSet&&(clearInterval(this.state.intervalIsSet),this.setState({intervalIsSet:null})),this.props.hasLoaded(!1)}},{key:"componentDidUpdate",value:function(){this.props.isOwner||0===this.state.ownerPlaying.length||(0===this.state.userUri.length?this.getURI(this.props.token):this.state.userUri[0]!==this.state.uri&&this.state.sync&&this.SyncSongs(this.props.token))}},{key:"displayOwner",value:function(){var e=this;return this.state.data.find((function(t){return t.group===e.props.group})).ownerName}},{key:"SyncSongs",value:function(e){var t=this;R.a.ajax({url:"https://api.spotify.com/v1/me/player/play",type:"PUT",data:JSON.stringify({uris:this.state.ownerPlaying,position_ms:this.state.position}),beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(){t.getURI(t.props.token),t.setState({sync:!1})}})}},{key:"getURI",value:function(e){var t=this;R.a.ajax({url:"https://api.spotify.com/v1/me/player",type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){"undefined"!==typeof e&&((null===e||void 0===e?void 0:e.item)?t.setState({userUri:[e.item.uri]}):t.setState({userUri:["Not Playing"]}))}})}},{key:"getCurrentlyPlaying",value:function(e){var t=this;R.a.ajax({url:"https://api.spotify.com/v1/me/player",type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){if("undefined"!==typeof e){var a=[e.item.uri];e.item.uri!==t.state.uri&&t.setState({item:e.item,uri:e.item.uri,ownerPlaying:a,sync:!0,position:e.progress_ms})}else t.props.isOwner||Object(D.confirmAlert)({title:"No Music Playing",message:"The group leader needs to start playing music to begin.",buttons:[{label:"OK"}]})}})}},{key:"render",value:function(){return this.props.isLoaded?this.props.isLoaded&&0===this.state.data.length?n.a.createElement("div",{className:"Group"},n.a.createElement("header",{className:"Group-header"},n.a.createElement("h1",{className:"Group-title"},"Listen Together"),n.a.createElement("img",{src:x.a,className:"Group-logoLeft",alt:"logo"}),n.a.createElement("img",{src:B.a,className:"Group-logoRight",alt:"logo"}),n.a.createElement("p",{className:"Group-curGroup"},"Loading..."),n.a.createElement("div",{className:"loader"}),n.a.createElement("p",{className:"Home-p"},"Created By Kyle Litton. ",n.a.createElement("a",{className:"Home-credit",href:"https://github.com/kyle-litton/ListenTogether"},"View Source")))):this.props.isLoaded&&!this.props.username?n.a.createElement("div",{className:"Group"},n.a.createElement("header",{className:"Group-header"},n.a.createElement("h1",{className:"Group-title"},"Listen Together"),n.a.createElement("img",{src:x.a,className:"Group-logoLeft",alt:"logo"}),n.a.createElement("img",{src:B.a,className:"Group-logoRight",alt:"logo"}),n.a.createElement("h3",{className:"Group-loadError"},"Something Went Wrong"),n.a.createElement("a",{className:"Group-tryAgain",href:"".concat(b,"?client_id=").concat(E,"&redirect_uri=").concat(v,"&scope=").concat(N.join("%20"),"&response_type=token&show_dialog=true")},"Try Again"))):this.props.isOwner?this.props.isOwner?n.a.createElement("div",{className:"Group"},n.a.createElement("header",{className:"Group-header"},n.a.createElement("h1",{className:"Group-title"},"Listen Together"),n.a.createElement("img",{src:x.a,className:"Group-logoLeft",alt:"logo"}),n.a.createElement("img",{src:B.a,className:"Group-logoRight",alt:"logo"}),n.a.createElement("p",{className:"Group-curGroup"},"Current Group: "+this.props.group),this.getCurrentlyPlaying(this.props.token),n.a.createElement("div",{className:"Group-player"},n.a.createElement(F,{item:this.state.item,uri:this.state.uri}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(M.a,{styles:{loaderColor:"#1db954",sliderColor:"#1db954"},autoPlay:!0,play:!0,showSaveIcon:!0,token:this.props.token,name:"Listen Together"}),";"),n.a.createElement("p",{className:"Home-p"},"Created By Kyle Litton. ",n.a.createElement("a",{className:"Home-credit",href:"https://github.com/kyle-litton/ListenTogether"},"View Source")))):void 0:n.a.createElement("div",{className:"Group"},n.a.createElement("header",{className:"Group-header"},n.a.createElement("h1",{className:"Group-title"},"Listen Together"),n.a.createElement("img",{src:x.a,className:"Group-logoLeft",alt:"logo"}),n.a.createElement("img",{src:B.a,className:"Group-logoRight",alt:"logo"}),this.getCurrentlyPlaying(this.props.ownerToken),n.a.createElement("div",{className:"Group-player"},n.a.createElement(F,{item:this.state.item,uri:this.state.uri}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(M.a,{styles:{loaderColor:"#1db954",sliderColor:"#1db954"},autoPlay:!0,play:!0,showSaveIcon:!0,token:this.props.token,name:"Listen Together"}),";"),n.a.createElement("p",{className:"Home-p"},"Created By Kyle Litton. ",n.a.createElement("a",{className:"Home-credit",href:"https://github.com/kyle-litton/ListenTogether"},"View Source")))):n.a.createElement("div",{className:"Group"},n.a.createElement("header",{className:"Group-header"},n.a.createElement("h1",{className:"Group-title"},"Listen Together"),n.a.createElement("img",{src:x.a,className:"Group-logoLeft",alt:"logo"}),n.a.createElement("img",{src:B.a,className:"Group-logoRight",alt:"logo"}),n.a.createElement("div",{className:"loader"})))}}]),a}(r.Component),V=Object(i.b)((function(e){return{isLoaded:e.uiReducer.isLoaded,group:e.userReducer.group,token:e.userReducer.token,username:e.userReducer.username,isOwner:e.userReducer.isOwner,ownerToken:e.userReducer.ownerToken}}),(function(e){return Object(c.b)({hasLoaded:U},e)}))(z),q=function(){return n.a.createElement(m.a,{basename:"/ListenTogether"},n.a.createElement("div",null,n.a.createElement(h.c,null,n.a.createElement(h.a,{path:"/",component:I,exact:!0}),n.a.createElement(h.a,{path:"/start",component:H}),n.a.createElement(h.a,{path:"/group",component:V}))))};a(89);var $=function(){return n.a.createElement(q,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(i.a,{store:Object(c.d)(p,Object(c.a)(l.a))},n.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[39,1,2]]]);
//# sourceMappingURL=main.81a4e3c7.chunk.js.map